(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(t,e,a){},130:function(t,e,a){t.exports=a(186)},150:function(t,e,a){},152:function(t,e,a){},154:function(t,e){t.exports={EARTH_RADIUS:6371e3,convertDegreesToRadians:function(t){return t*Math.PI/180},convertRadiansToDegrees:function(t){return 180*t/Math.PI},computeBearings:function(t,e,a,n){var r=Math.sin(n-e)*Math.cos(a),i=Math.cos(t)*Math.sin(a)-Math.sin(t)*Math.cos(a)*Math.cos(n-e),o=Math.atan2(r,i);return(this.convertRadiansToDegrees(o)+180)%360},calculateDestinationPoint:function(t,e,a,n){var r=this.convertDegreesToRadians(t),i=this.convertDegreesToRadians(e),o=n/this.EARTH_RADIUS,s=this.convertDegreesToRadians(a),c=Math.asin(Math.sin(r)*Math.cos(o)+Math.cos(r)*Math.sin(o)*Math.cos(s)),u=this.convertRadiansToDegrees(c),l=Math.sin(s)*Math.sin(o)*Math.cos(r),p=Math.cos(o)-Math.sin(r)*Math.sin(c),d=i+Math.atan2(l,p);return{lat:u,long:(this.convertRadiansToDegrees(d)+540)%360-180}},calculateDistance:function(t,e,a,n){var r=this.convertDegreesToRadians(a-t),i=this.convertDegreesToRadians(n-e),o=this.convertDegreesToRadians(t),s=this.convertDegreesToRadians(a),c=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(o)*Math.cos(s),u=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return this.EARTH_RADIUS*u}}},158:function(t,e,a){},160:function(t,e,a){},163:function(t,e,a){},186:function(t,e,a){"use strict";a.r(e);var n=a(5),r=a.n(n),i=a(102),o=a.n(i),s=a(59),c=a(56),u=a(57),l=a(60),p=a(58),d=a(61),m=a(95),h=(a(148),"services/alarms/CREATE_NEW_ALARM"),v="services/alarms/DELETE_ALARM",f="services/alarms/START_ALARM",T="services/alarms/STOP_ALARM",E="notifications/DISPATCH_NOTIFICATIONS",y="notifications/REMOVE_NOTIFICATION",b=(a(150),a(28)),g=(a(152),0),I=4,O=10,_=new Date;function R(){var t=O.toString().padStart(2,"0"),e=I.toString().padStart(2,"0"),a=g.toString().padStart(2,"0");return new Date("August 19, 1975 "+(t+":"+e+":"+a))}function N(t){var e=Math.trunc(t/3600);t%=3600;var a=Math.trunc(t/60);t%=60;var n="",r="hours";return e>=1?1===e&&0===a?(n="1",r="hour"):(n=e+":"+Math.trunc(a).toString().padStart(2,"0"),r="hours"):a>=1?1===a&&0===t?(n="1",r="minute"):(n=a+":"+Math.trunc(t).toString().padStart(2,"0"),r="minutes"):1===t?(n="1",r="second"):(n=t.toString(),r="seconds"),{value:n,unit:r}}function S(t){var e=t.getHours(),a=t.getMinutes();return t.getSeconds()+60*a+3600*e}setInterval(function(){var t=new Date;if(t!==_){var e=t.getTime()-_.getTime();(g+=e/1e3)>=60&&(g=0,I++),I>=60&&(I=0,O++),O>=24&&(O=0),_=t}});var A=a(154);function L(t,e,a,n){for(var r=function(t,e,a){for(var n=0,r=e;r<a;r++){var i=t[r],o=t[r+1],s=i.lat,c=i.long,u=o.lat,l=o.long;n+=A.calculateDistance(s,c,u,l)}return n}(t,e,a)*n,i=e;i<a;){var o=t[i],s=t[i+1],c=o.lat,u=o.long,l=s.lat,p=s.long,d=A.calculateDistance(c,u,l,p);if(r-d<0)break;r-=d,i++}if(i===a)return{lat:t[i].lat,long:t[i].long};var m=t[i],h=t[i+1],v=A.computeBearings(h.lat,h.long,m.lat,m.long);return A.calculateDestinationPoint(m.lat,m.long,v,r)}function C(t,e){for(var a=0,n=0,r=0,i=1/0;a<e.length;){var o=e[a],s=A.calculateDistance(t.lat,t.long,o.lat,o.long);s<i?(i=s,n=a,r=a):s-i<1e-12&&(r=a),a++}return{minIndex:n,maxIndex:r}}function j(t,e,a){var n=function(t,e){for(var a=0,n=t.length;a<=n;){var r=Math.floor((a+n)/2),i=r+1,o=t[r],s=t[i];if(o.time<=e&&e<=s.time)return[r,i];e<o.time?n=r-1:a=r+1}throw new Error("Cannot find boundary between two stops!")}(t,a),r=t[n[0]],i=t[n[1]];return L(e,C(r,e).minIndex,C(i,e).maxIndex,(a-r.time)/(i.time-r.time))}a(155);var P=a(15),D=a(187),w=a(191),M=a(190),F=a(192),x=a(119),k=a(98),H=a(97),U=a(64),W=a(75),B=a(79),G=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(l.a)(this,Object(p.a)(e).call(this,t))).state={location:{latitude:0,longitude:0}},a.startPredictedLocationWatch=function(){a.liveLocationWatch&&a.stopLiveLocationWatch(),a.liveLocationWatch=setInterval(function(){var t=S(R());if(a.props.stops&&a.props.stops.length>1){var e=a.props.stops,n=a.props.path;if(t<=e[e.length-1].time){var r=j(e,n,t);a.setState(function(t,e){return Object(b.a)({},t,{location:{latitude:r.lat,longitude:r.long}})})}}})},a.stopLiveLocationWatch=function(){a.liveLocationWatch&&(clearInterval(a.liveLocationWatch),a.liveLocationWatch=null)},a.createStopsLayer=function(){var t=new W.b({image:new B.a({radius:5,fill:null,stroke:new U.a({color:"red",width:1})})});return new M.a({source:new k.a,style:function(e){return t}})},a.updateStopsLayer=function(t){var e={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:t.map(function(t){return{type:"Feature",geometry:{type:"Point",coordinates:Object(P.c)([t.long,t.lat])}}})};if(a.olStopsLayer){var n=a.olStopsLayer.getSource();n&&(n.clear(),n.addFeatures((new H.a).readFeatures(e)),n.refresh())}},a.createPathLayer=function(){var t=new W.b({stroke:new U.a({color:"green",width:3})});return new M.a({source:new k.a,style:function(e){return t}})},a.updatePathLayer=function(t){var e={type:"Feature",geometry:{type:"LineString",coordinates:t.map(function(t){return Object(P.c)([t.long,t.lat])})}};if(a.olPathLayer){var n=a.olPathLayer.getSource();n&&(n.clear(),n.addFeature((new H.a).readFeature(e)),n.refresh())}},a.createLiveLocationLayer=function(){var t=new W.b({image:new B.a({radius:10,fill:null,stroke:new U.a({color:"blue",width:2})})});return new M.a({source:new k.a,style:function(e){return t}})},a.updateLiveLocationLayer=function(t,e){var n={type:"Feature",geometry:{type:"Point",coordinates:Object(P.c)([e,t])}};if(a.olLiveLocationLayer){var r=a.olLiveLocationLayer.getSource();r&&(r.clear(),r.addFeature((new H.a).readFeature(n)),r.refresh())}},a.updateMap=function(t,e,n,r){if(a.olMap){var i={},o=t&&e&&null===t.path&&null!==e.path,s=t&&e&&null!==t.path&&null===e.path;if(o){var c=e.path.reduce(function(t,e){return t+e.lat},0),u=e.path.reduce(function(t,e){return t+e.long},0),l=c/e.path.length,p=u/e.path.length;i.center=Object(P.c)([p,l]),i.duration=2e3,i.zoom=13}else s&&(i.center=Object(P.c)([0,0]),i.duration=2e3,i.zoom=2);i!=={}&&a.olView.animate(i),e&&e.path&&e.stops&&(a.updatePathLayer(e.path),a.updateStopsLayer(e.stops));var d=r.location.latitude,m=r.location.longitude;a.updateLiveLocationLayer(d,m)}},a.olMap=null,a.olPathLayer=null,a.olStopsLayer=null,a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){this.olView=new D.a({center:Object(P.c)([0,0]),zoom:2}),this.olPathLayer=this.createPathLayer(),this.olStopsLayer=this.createStopsLayer(),this.olLiveLocationLayer=this.createLiveLocationLayer(),this.olMap=new w.a({target:"map",layers:[new F.a({source:new x.a}),this.olPathLayer,this.olStopsLayer,this.olLiveLocationLayer],loadTilesWhileAnimating:!0,view:this.olView}),this.startPredictedLocationWatch()}},{key:"componentWillMount",value:function(){this.stopLiveLocationWatch()}},{key:"componentWillUpdate",value:function(t,e){this.updateDimensions(),this.updateMap(this.props,t,this.state,e)}},{key:"updateDimensions",value:function(){var t=this;setTimeout(function(){t.olMap.updateSize()},200)}},{key:"render",value:function(){return r.a.createElement("div",{id:"map",className:"map"})}}]),e}(r.a.Component);var Y=Object(s.b)(function(t){return{stops:t.selectedTrip.tripDetails?t.selectedTrip.tripDetails.stops:null,path:t.selectedTrip.tripDetails?t.selectedTrip.tripDetails.path:null,type:t.selectedTrip.tripDetails?t.selectedTrip.tripDetails.type:null}},{})(G),K=(a(158),function(t){function e(){var t,a;Object(c.a)(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(i)))).state={lastUpdated:-1,stops:[],stopsWithAlarms:{}},a.updateStops=function(){var t=S(R());if(t>a.state.lastUpdated){var e=a.props.stops.map(function(t,e){return Object(b.a)({},t,{stopIndex:e})}).filter(function(e){return e.time>t}).map(function(e){var n=N(e.time-t),r=void 0!==a.props.alarms[e.time];return Object(b.a)({},e,{remainingTime:n,hasAlarm:r})});a.setState(function(a,n){return{lastUpdated:t,stops:e}})}},a.addAlarm=function(t){var e=a.props.stops[t],n=S(R()),r=Math.max(e.time-300,n);if(r>n){a.props.createAlarm(r,function(){var n=S(R()),r=N(e.time-n),i="You are ".concat(r.value," ")+"".concat(r.unit," away from ").concat(e.name);a.props.createNotification(i,1e4);var o=Object.assign({},a.state.stopsWithAlarms);delete o[t],a.setState(function(t,e){return Object(b.a)({},t,{stopsWithAlarms:o})})});var i="You will be notified 5 minutes before reaching ".concat(e.name);a.props.createNotification(i,1e4);var o=Object.assign({},a.state.stopsWithAlarms);o[t]=r,a.setState(function(t,e){return Object(b.a)({},t,{stopsWithAlarms:o})})}else{var s=N(e.time-n),c="You are ".concat(s.value," ")+"".concat(s.unit," away from ").concat(e.name);a.props.createNotification(c,1e4)}},a.removeAlarm=function(t){var e=a.state.stopsWithAlarms[t];a.props.deleteAlarm(e);var n=Object.assign({},a.state.stopsWithAlarms);delete n[t];var r=a.props.stops[t],i="Removed notification for ".concat(r.name);a.props.createNotification(i,1e4),a.setState(function(t,e){return Object(b.a)({},t,{stopsWithAlarms:n})})},a.onAlarmButtonClick=function(t){a.state.stopsWithAlarms[t]?a.removeAlarm(t):a.addAlarm(t)},a.renderListItem=function(t){return r.a.createElement("div",{key:t.stopIndex,className:"stop-container"},r.a.createElement("div",{className:"stop-info-container"},r.a.createElement("div",{className:"stop-name"},t.name),r.a.createElement("div",{className:"remaining-time"},r.a.createElement("div",{className:"remaining-time-value"},t.remainingTime.value),r.a.createElement("div",{className:"remaining-time-unit"},t.remainingTime.unit))),r.a.createElement("div",{className:"stop-interactions-container"},r.a.createElement("div",{className:"stop-interactions"},r.a.createElement("div",{className:void 0!==a.state.stopsWithAlarms[t.stopIndex]?"stop-interaction-button stop-interaction-button-selected":"stop-interaction-button",onClick:function(){return a.onAlarmButtonClick(t.stopIndex)}},"Notify me"))))},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.updateStops)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.timer=null}},{key:"render",value:function(){var t=this,e=this.state.stops.map(function(e){return t.renderListItem(e)});return r.a.createElement("div",null,r.a.createElement("div",{className:"trip-header-details-container"},r.a.createElement("div",{className:"trip-header-details"},r.a.createElement("h3",{className:"short-name"},this.props.tripShortName),r.a.createElement("p",{className:"long-name"},this.props.tripLongName))),r.a.createElement("div",{className:"stop-containers-list"},e))}}]),e}(r.a.Component));var q={createAlarm:function(t,e){return{type:h,payload:{time:t,dispatcher:e}}},deleteAlarm:function(t){return{type:v,payload:{time:t}}},createNotification:function(t,e){return{type:E,payload:{message:t,duration:e}}}},z=Object(s.b)(function(t){return{tripShortName:t.selectedTrip.tripDetails.shortName,tripLongName:t.selectedTrip.tripDetails.longName,tripHeadSign:t.selectedTrip.tripDetails.headSign,stops:t.selectedTrip.tripDetails.stops,alarms:t.alarms.alarms}},q)(K),V=(a(160),a(112),a(163),function(t){function e(){return Object(c.a)(this,e),Object(l.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"popup-background"},r.a.createElement("div",{className:"popup-container"},r.a.createElement("div",{className:"popup"},r.a.createElement("div",{className:"popup-header"}),r.a.createElement("div",{className:"popup-contents"},r.a.createElement("div",{className:"loader"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)),r.a.createElement("h2",{className:"loading-sign"},"Loading...")),r.a.createElement("div",{className:"popup-actions-container"}))))}}]),e}(r.a.Component)),J={FETCH_NEARBY_TRIPS:"route-chooser/FETCH_NEARBY_TRIPS",FETCH_NEARBY_TRIPS_IN_PROGRESS:"route-chooser/FETCH_NEARBY_TRIPS_IN_PROGRESS",FETCH_NEARBY_TRIPS_SUCCESS:"route-chooser/FETCH_NEARBY_TRIPS_SUCCESS",FETCH_NEARBY_TRIPS_FAILURE:"route-chooser/FETCH_NEARBY_TRIPS_FAILURE"};var Q={START_TRACKING_CURRENT_LOCATION:"services/location/START_TRACKING_CURRENT_LOCATION",STOP_TRACKING_CURRENT_LOCATION:"services/location/STOP_TRACKING_CURRENT_LOCATION",CURRENT_LOCATION_CHANGED:"services/location/CURRENT_LOCATION_CHANGED"};var X={FETCH_TRIP_DETAILS:"select-trip/FETCH_TRIP_DETAILS",FETCH_TRIP_DETAILS_IN_PROGRESS:"select-trip/FETCH_TRIP_DETAILS_IN_PROGRESS",FETCH_TRIP_DETAILS_SUCCESS:"select-trip/FETCH_TRIP_DETAILS_SUCCESS",FETCH_TRIP_DETAILS_FAILURE:"select-trip/FETCH_TRIP_DETAILS_FAILURE"},Z=function(t){function e(){var t,a;Object(c.a)(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(i)))).handleSubmit=function(t){t.preventDefault();var e=t.target.route.value.split("/"),n=e[0],r=e[1];a.props.selectTrip(n,r)},a.renderLoadingSign=function(){return r.a.createElement(V,null)},a.renderNoNearbyTripsPopup=function(){return r.a.createElement("div",{className:"popup-background"},r.a.createElement("div",{className:"popup-container"},r.a.createElement("div",{className:"popup"},r.a.createElement("div",{className:"popup-header"},r.a.createElement("div",null,r.a.createElement("h3",null,"There are no busses / trains near you!"),r.a.createElement("p",null,"Are you on a bus / train? If not, this explains why we cannot find your bus / train!"))),r.a.createElement("div",{className:"popup-contents"},r.a.createElement("p",null,"Please wait while we try to determine the busses / trains around you.")))))},a.renderNearbyTripsPopup=function(){return r.a.createElement("div",{className:"popup-background"},r.a.createElement("div",{className:"popup-container"},r.a.createElement("div",{className:"popup"},r.a.createElement("div",{className:"popup-header"},r.a.createElement("div",null,r.a.createElement("h3",null,"Which bus / train are you on?"),r.a.createElement("p",null,"There are multiple bus / train routes near your area. Please select which route you are currently on."))),r.a.createElement("form",{onSubmit:a.handleSubmit},r.a.createElement("div",{className:"popup-contents"},Object.keys(a.props.nearbyTrips).map(function(t){var e=a.props.nearbyTrips[t],n=e.shortname,i=e.longname,o=e.headsign;return e.schedules.map(function(e){var a="";n&&(a+=n+" "),o&&(a+=o+" "),i&&(a+="("+i+")"),a.trim();var s=t+"/"+e;return r.a.createElement("div",{key:s},r.a.createElement("input",{type:"radio",name:"route",value:s}),r.a.createElement("div",{className:"tripInfo"},a))})})),r.a.createElement("div",{className:"popup-actions-container"},r.a.createElement("button",{className:"popup-action-button",type:"submit"},"OK"))))))},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){this.props.startTrackingLocation()}},{key:"componentWillUnmount",value:function(){this.props.stopTrackingLocation()}},{key:"componentWillUpdate",value:function(t,e){if(this.props.latitude!==t.latitude||this.props.longitude!==t.longitude||this.props.radius!==t.radius){var a=R().toLocaleTimeString();return this.props.getNearbyTrips(43.554,-79.72208,a,t.radius),!1}return!0}},{key:"render",value:function(){return this.props.nearbyTripsInProgress||this.props.selectedTripsInProgress?this.renderLoadingSign():0===Object.keys(this.props.nearbyTrips).length?this.renderNoNearbyTripsPopup():this.renderNearbyTripsPopup()}}]),e}(r.a.Component);var $={getNearbyTrips:function(t,e,a,n){return{type:J.FETCH_NEARBY_TRIPS,payload:{latitude:t,longitude:e,time:a,radius:n}}},selectTrip:function(t,e){return{type:X.FETCH_TRIP_DETAILS,payload:{tripID:t,scheduleID:e}}},startTrackingLocation:function(){return{type:Q.START_TRACKING_CURRENT_LOCATION}},stopTrackingLocation:function(){return{type:Q.STOP_TRACKING_CURRENT_LOCATION}}},tt=Object(s.b)(function(t){return{nearbyTrips:t.nearbyTrips.tripIDs,nearbyTripsInProgress:t.nearbyTrips.inProgress,selectedTripsInProgress:t.selectedTrip.inProgress,latitude:t.currentLocation.latitude,longitude:t.currentLocation.longitude,radius:t.currentLocation.radius}},$)(Z),et=function(t){function e(){var t,a;Object(c.a)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(r)))).dispatchNotification=function(t,e){Notification.requestPermission().then(function(t){if("granted"!==t)throw new Error("No access!")}).then(function(){var a=new Notification(t);setTimeout(function(){a.close()},e)}).catch(function(){console.log("We have no access here!")}),Object(m.toast)(t,{position:m.toast.POSITION.BOTTOM_CENTER})},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){"Notification"in window||alert("Notifications are not supported in this browser!"),Notification.requestPermission(),this.props.startAlarm()}},{key:"componentWillUnmount",value:function(){this.props.stopAlarm()}},{key:"render",value:function(){if(null!==this.props.notifications.text){var t=this.props.notifications.text,e=this.props.notifications.duration;this.dispatchNotification(t,e)}return r.a.createElement("div",{className:"app-container"},this.props.displayTripDetails?r.a.createElement("div",{className:"left-panel"},r.a.createElement(z,null)):null,r.a.createElement("div",{className:"right-panel"},r.a.createElement(Y,null)),this.props.displayTripDetails?null:r.a.createElement(tt,null),r.a.createElement(m.ToastContainer,null))}}]),e}(r.a.Component);var at={startAlarm:function(){return{type:f}},stopAlarm:function(){return{type:T}},removeNotification:function(){return{type:y}}},nt=Object(s.b)(function(t){return{displayTripDetails:null!==t.selectedTrip.tripID,notifications:{text:t.notifications.text,duration:t.notifications.duration}}},at)(et),rt=a(23),it=a.n(rt),ot=a(66),st=a(120),ct=a(33),ut=a(96),lt=a(83),pt=a.n(lt);pt.a.defaults.timeout=18e4;var dt="https://on-transit-app-api-gateway.herokuapp.com/api/v1/trips",mt="https://on-transit-app-api-gateway.herokuapp.com/api/v1/trips";function ht(t,e,a,n){return vt.apply(this,arguments)}function vt(){return(vt=Object(ut.a)(it.a.mark(function t(e,a,n,r){var i,o;return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i={params:{lat:e,long:a,time:n,radius:r}},t.next=5,pt.a.get(dt,i);case 5:return o=t.sent,t.abrupt("return",o.data.data);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,this,[[0,9]])}))).apply(this,arguments)}function ft(t,e){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(ut.a)(it.a.mark(function t(e,a){var n,r;return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=mt+"/"+e+"/schedules/"+a,t.next=4,pt.a.get(n);case 4:return r=t.sent,t.abrupt("return",r.data.data);case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}},t,this,[[0,8]])}))).apply(this,arguments)}var Et=it.a.mark(bt),yt=it.a.mark(gt);function bt(t){var e,a,n,r,i,o;return it.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e=t.payload,a=e.latitude,n=e.longitude,r=e.time,i=e.radius,s.next=7,Object(ct.c)({type:J.FETCH_NEARBY_TRIPS_IN_PROGRESS});case 7:return s.prev=7,s.next=10,Object(ct.b)(ht,a,n,r,i);case 10:return o=s.sent,s.next=13,Object(ct.c)({type:J.FETCH_NEARBY_TRIPS_SUCCESS,payload:o});case 13:s.next=19;break;case 15:return s.prev=15,s.t0=s.catch(7),s.next=19,Object(ct.c)({type:J.FETCH_NEARBY_TRIPS_FAILURE});case 19:case"end":return s.stop()}},Et,this,[[7,15]])}function gt(){return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ct.d)(J.FETCH_NEARBY_TRIPS,bt);case 2:case"end":return t.stop()}},yt,this)}var It={enableHighAccuracy:!0,timeout:1/0,maximumAge:0},Ot=null;function _t(t){var e=t.onSuccess,a=t.onError;Ot||(Ot=navigator.geolocation.watchPosition(e,a,It))}function Rt(){Ot&&clearInterval(Ot)}var Nt=it.a.mark(jt),St=it.a.mark(Pt),At=it.a.mark(Dt);function Lt(t){var e={latitude:t.coords.latitude,longitude:t.coords.longitude,radius:t.coords.accuracy};ae.dispatch({type:Q.CURRENT_LOCATION_CHANGED,payload:e})}function Ct(t){console.error(t)}function jt(){var t;return it.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={onSuccess:Lt,onError:Ct},e.next=3,Object(ct.b)(_t,t);case 3:case"end":return e.stop()}},Nt,this)}function Pt(){return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ct.b)(Rt);case 2:case"end":return t.stop()}},St,this)}function Dt(){return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ct.d)(Q.START_TRACKING_CURRENT_LOCATION,jt);case 2:return t.next=4,Object(ct.d)(Q.STOP_TRACKING_CURRENT_LOCATION,Pt);case 4:case"end":return t.stop()}},At,this)}var wt=it.a.mark(Ft),Mt=it.a.mark(xt);function Ft(t){var e,a,n,r,i;return it.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return e=t.payload,a=e.tripID,n=e.scheduleID,o.next=5,Object(ct.c)({type:X.FETCH_TRIP_DETAILS_IN_PROGRESS});case 5:return o.prev=5,o.next=8,Object(ct.b)(ft,a,n);case 8:return r=o.sent,i={tripDetails:r,tripID:a,scheduleID:n},o.next=12,Object(ct.c)({type:X.FETCH_TRIP_DETAILS_SUCCESS,payload:i});case 12:o.next=18;break;case 14:return o.prev=14,o.t0=o.catch(5),o.next=18,Object(ct.c)({type:X.FETCH_TRIP_DETAILS_FAILURE,payload:o.t0});case 18:case"end":return o.stop()}},wt,this,[[5,14]])}function xt(){return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ct.d)(X.FETCH_TRIP_DETAILS,Ft);case 2:case"end":return t.stop()}},Mt,this)}var kt,Ht,Ut,Wt,Bt=a(30),Gt=function(t,e){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments.length>1?arguments[1]:void 0;return e.hasOwnProperty(n.type)?e[n.type](a,n):a}},Yt=Gt({inProgress:!0,tripIDs:{},error:null},(kt={},Object(Bt.a)(kt,J.FETCH_NEARBY_TRIPS_IN_PROGRESS,function(t,e){e.payload;return Object(b.a)({},t,{inProgress:!0})}),Object(Bt.a)(kt,J.FETCH_NEARBY_TRIPS_SUCCESS,function(t,e){var a=e.payload;return Object(b.a)({},t,{inProgress:!1,tripIDs:a.tripIDs,error:null})}),Object(Bt.a)(kt,J.FETCH_NEARBY_TRIPS_FAILURE,function(t,e){var a=e.payload;return Object(b.a)({},t,{inProgress:!1,tripIDs:{},error:a})}),kt)),Kt=Gt({latitude:43.553178,longitude:-79.723189,radius:0},Object(Bt.a)({},Q.CURRENT_LOCATION_CHANGED,function(t,e){var a=e.payload,n=a.latitude,r=a.longitude,i=a.radius;return Object(b.a)({},t,{latitude:n,longitude:r,radius:i})})),qt=Gt({inProgress:!1,tripID:null,scheduleID:null,tripDetails:null},(Ht={},Object(Bt.a)(Ht,X.FETCH_TRIP_DETAILS_IN_PROGRESS,function(t,e){e.payload;return Object(b.a)({},t,{inProgress:!0})}),Object(Bt.a)(Ht,X.FETCH_TRIP_DETAILS_SUCCESS,function(t,e){var a=e.payload;return Object(b.a)({},t,{inProgress:!1,error:null,tripID:a.tripID,scheduleID:a.scheduleID,tripDetails:a.tripDetails})}),Object(Bt.a)(Ht,X.FETCH_TRIP_DETAILS_FAILURE,function(t,e){var a=e.payload;return Object(b.a)({},t,{inProgress:!1,error:a.error})}),Ht)),zt=null,Vt={},Jt=function(t){Vt[t]&&delete Vt[t]},Qt=function(){return Vt},Xt=Gt({alarms:{},isAlarmRunning:!1},(Ut={},Object(Bt.a)(Ut,h,function(t,e){var a=e.payload;return function(t,e){void 0===Vt[t]&&(Vt[t]=e)}(a.time,a.dispatcher),Object(b.a)({},t,{alarms:Qt()})}),Object(Bt.a)(Ut,v,function(t,e){var a=e.payload,n=a.time,r=a.dispatcher;return Jt(n,r),Object(b.a)({},t,{alarms:Qt()})}),Object(Bt.a)(Ut,f,function(t,e){return zt||(zt=setInterval(function(){var t=S(R());void 0!==Vt[t]&&(Vt[t](),Jt(t))})),t}),Object(Bt.a)(Ut,T,function(t,e){return zt&&clearInterval(zt),t}),Ut)),Zt=Gt({text:null,duration:0},(Wt={},Object(Bt.a)(Wt,E,function(t,e){var a=e.payload,n=a.message,r=a.duration;return Object(b.a)({},t,{text:n,duration:r})}),Object(Bt.a)(Wt,y,function(t,e){e.payload;return{text:null,duration:null}}),Wt)),$t=Object(ot.c)({nearbyTrips:Yt,selectedTrip:qt,currentLocation:Kt,alarms:Xt,notifications:Zt}),te=it.a.mark(ne),ee=Object(st.a)(),ae=Object(ot.e)($t,Object(ot.a)(ee));function ne(){return it.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ct.a)([gt(),Dt(),xt()]);case 2:case"end":return t.stop()}},te,this)}ee.run(ne),o.a.render(r.a.createElement(s.a,{store:ae},r.a.createElement(nt,null)),document.getElementById("root"))}},[[130,2,1]]]);
//# sourceMappingURL=main.584f3ca7.chunk.js.map